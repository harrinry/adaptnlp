---

title: Embeddings


keywords: fastai
sidebar: home_sidebar

summary: "AdaptNLP Embeddings Module"
description: "AdaptNLP Embeddings Module"
nb_path: "nbs/04_embeddings.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/04_embeddings.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="EmbeddingResult" class="doc_header"><code>class</code> <code>EmbeddingResult</code><a href="https://github.com/novetta/adaptnlp/tree/master/adaptnlp/embeddings.py#L89" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>EmbeddingResult</code>(<strong><code>sentence</code></strong>:<code>Sentence</code>)</p>
</blockquote>
<p>A result class designed for Embedding models</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="EasyWordEmbeddings" class="doc_header"><code>class</code> <code>EasyWordEmbeddings</code><a href="https://github.com/novetta/adaptnlp/tree/master/adaptnlp/embeddings.py#L165" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>EasyWordEmbeddings</code>()</p>
</blockquote>
<p>Word embeddings from the latest language models</p>
<p>Usage:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">embeddings</span> <span class="o">=</span> <span class="n">adaptnlp</span><span class="o">.</span><span class="n">EasyWordEmbeddings</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">embeddings</span><span class="o">.</span><span class="n">embed_text</span><span class="p">(</span><span class="s2">&quot;text you want embeddings for&quot;</span><span class="p">,</span> <span class="n">model_name_or_path</span><span class="o">=</span><span class="s2">&quot;bert-base-cased&quot;</span><span class="p">)</span>
</pre></div>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="EasyStackedEmbeddings" class="doc_header"><code>class</code> <code>EasyStackedEmbeddings</code><a href="https://github.com/novetta/adaptnlp/tree/master/adaptnlp/embeddings.py#L242" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>EasyStackedEmbeddings</code>(<strong>*<code>embeddings</code></strong>:<code>str</code>)</p>
</blockquote>
<p>Word Embeddings that have been concatenated and "stacked" as specified by flair</p>
<p>Usage:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">embeddings</span> <span class="o">=</span> <span class="n">adaptnlp</span><span class="o">.</span><span class="n">EasyStackedEmbeddings</span><span class="p">(</span><span class="s2">&quot;bert-base-cased&quot;</span><span class="p">,</span> <span class="s2">&quot;gpt2&quot;</span><span class="p">,</span> <span class="s2">&quot;xlnet-base-cased&quot;</span><span class="p">)</span>
</pre></div>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>embeddings</code> - Non-keyword variable number of strings specifying the embeddings you want to stack</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="EasyDocumentEmbeddings" class="doc_header"><code>class</code> <code>EasyDocumentEmbeddings</code><a href="https://github.com/novetta/adaptnlp/tree/master/adaptnlp/embeddings.py#L292" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>EasyDocumentEmbeddings</code>(<strong>*<code>embeddings</code></strong>:<code>str</code>, <strong><code>methods</code></strong>:<code>List</code>[<code>str</code>]=<em><code>['rnn', 'pool']</code></em>, <strong><code>configs</code></strong>:<code>Dict</code>[<code>KT</code>, <code>VT</code>]=<em><code>{'pool_configs': {'fine_tune_mode': 'linear', 'pooling': 'mean'}, 'rnn_configs': {'hidden_size': 512, 'rnn_layers': 1, 'reproject_words': True, 'reproject_words_dimension': 256, 'bidirectional': False, 'dropout': 0.5, 'word_dropout': 0.0, 'locked_dropout': 0.0, 'rnn_type': 'GRU', 'fine_tune': True}}</code></em>)</p>
</blockquote>
<p>Document Embeddings generated by pool and rnn methods applied to the word embeddings of text</p>
<p>Usage:</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">embeddings</span> <span class="o">=</span> <span class="n">adaptnlp</span><span class="o">.</span><span class="n">EasyDocumentEmbeddings</span><span class="p">(</span><span class="s2">&quot;bert-base-cased&quot;</span><span class="p">,</span> <span class="s2">&quot;xlnet-base-cased&quot;</span><span class="p">,</span> <span class="n">methods</span><span class="p">[</span><span class="s2">&quot;rnn&quot;</span><span class="p">])</span>
</pre></div>
<p><strong>Parameters:</strong></p>
<ul>
<li><code>embeddings</code> - Non-keyword variable number of strings referring to model names or paths</li>
<li><code>methods</code> - A list of strings to specify which document embeddings to use i.e. ["rnn", "pool"] (avoids unncessary loading of models if only using one)</li>
<li><code>configs</code> - A dictionary of configurations for flair's rnn and pool document embeddings<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">example_configs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;pool_configs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;fine_tune_mode&quot;</span><span class="p">:</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="s2">&quot;pooling&quot;</span><span class="p">:</span> <span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="p">},</span>
<span class="o">...</span>                   <span class="s2">&quot;rnn_configs&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;hidden_size&quot;</span><span class="p">:</span> <span class="mi">512</span><span class="p">,</span>
<span class="o">...</span>                                   <span class="s2">&quot;rnn_layers&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<span class="o">...</span>                                   <span class="s2">&quot;reproject_words&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="o">...</span>                                   <span class="s2">&quot;reproject_words_dimension&quot;</span><span class="p">:</span> <span class="mi">256</span><span class="p">,</span>
<span class="o">...</span>                                   <span class="s2">&quot;bidirectional&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
<span class="o">...</span>                                   <span class="s2">&quot;dropout&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="o">...</span>                                   <span class="s2">&quot;word_dropout&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="o">...</span>                                   <span class="s2">&quot;locked_dropout&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
<span class="o">...</span>                                   <span class="s2">&quot;rnn_type&quot;</span><span class="p">:</span> <span class="s2">&quot;GRU&quot;</span><span class="p">,</span>
<span class="o">...</span>                                   <span class="s2">&quot;fine_tune&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="p">},</span>
<span class="o">...</span>                  <span class="p">}</span>
</pre></div>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

