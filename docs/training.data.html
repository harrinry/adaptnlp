---

title: Data


keywords: fastai
sidebar: home_sidebar

summary: "The data API"
description: "The data API"
nb_path: "nbs/15_training.data.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/15_training.data.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-API">The API<a class="anchor-link" href="#The-API"> </a></h2><p>AdaptNLP's data api takes inspiration from <a href="https://docs.fast.ai">fastai</a>'s <code>DataBlock</code> API, as well has has partial compatibility with it.</p>
<p>There is a medium and high-level API through <code>TaskDataset</code>, and individual task wrappers.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ColReader" class="doc_header"><code>class</code> <code>ColReader</code><a href="https://github.com/novetta/adaptnlp/tree/master/adaptnlp/training/data.py#L17" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ColReader</code>(<strong><code>cols</code></strong>, <strong><code>pref</code></strong>:<code>str</code>=<em><code>''</code></em>, <strong><code>suff</code></strong>:<code>str</code>=<em><code>''</code></em>, <strong><code>label_delim</code></strong>:<code>str</code>=<em><code>None</code></em>)</p>
</blockquote>
<p>Reads <code>cols</code> in <code>row</code> with potential <code>pref</code> and <code>suff</code>
Based on the fastai class</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Categorize" class="doc_header"><code>class</code> <code>Categorize</code><a href="https://github.com/novetta/adaptnlp/tree/master/adaptnlp/training/data.py#L44" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Categorize</code>(<strong><code>names</code></strong>, <strong><code>sort</code></strong>=<em><code>True</code></em>)</p>
</blockquote>
<p>Collection of categories with reverse mapping in <code>o2i</code>
Based on the fastai class</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="RandomSplitter" class="doc_header"><code>RandomSplitter</code><a href="https://github.com/novetta/adaptnlp/tree/master/adaptnlp/training/data.py#L78" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>RandomSplitter</code>(<strong><code>valid_pct</code></strong>=<em><code>0.2</code></em>, <strong><code>seed</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Creates a function that splits some items between train and validation with <code>valid_pct</code> randomly</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="TaskDatasets" class="doc_header"><code>class</code> <code>TaskDatasets</code><a href="https://github.com/novetta/adaptnlp/tree/master/adaptnlp/training/data.py#L90" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>TaskDatasets</code>(<strong><code>items</code></strong>, <strong><code>splits</code></strong>=<em><code>None</code></em>, <strong><code>tokenizer_name</code></strong>:<code>str</code>=<em><code>None</code></em>, <strong><code>tokenize</code></strong>:<code>bool</code>=<em><code>True</code></em>)</p>
</blockquote>
<p>A set of datasets for a particular task, with a simple API.</p>
<p>Note: This is the base API, <code>items</code> should be a set of regular text and model-ready labels,
      including label or one-hot encoding being applied.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SequenceClassificationDatasets" class="doc_header"><code>class</code> <code>SequenceClassificationDatasets</code><a href="https://github.com/novetta/adaptnlp/tree/master/adaptnlp/training/data.py#L151" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SequenceClassificationDatasets</code>(<strong><code>items</code></strong>, <strong><code>get_x</code></strong>=<em><code>&lt;adaptnlp.training.data.ColReader object at 0x7f6e5e5a9b20&gt;</code></em>, <strong><code>get_y</code></strong>=<em><code>&lt;adaptnlp.training.data.ColReader object at 0x7f6e5e5b06a0&gt;</code></em>, <strong><code>splits</code></strong>=<em><code>None</code></em>, <strong><code>tokenizer_name</code></strong>:<code>str</code>=<em><code>None</code></em>, <strong><code>tokenize</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong>**<code>kwargs</code></strong>) :: <a href="/adaptnlptraining.data.html#TaskDatasets"><code>TaskDatasets</code></a></p>
</blockquote>
<p>A set of datasets designed for sequence classification</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai.data.external</span> <span class="kn">import</span> <span class="n">URLs</span><span class="p">,</span> <span class="n">untar_data</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">IMDB_SAMPLE</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;texts.csv&#39;</span><span class="p">)</span>
<span class="n">dsets</span> <span class="o">=</span> <span class="n">SequenceClassificationDatasets</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span>
    <span class="n">df</span><span class="p">,</span>
    <span class="s1">&#39;text&#39;</span><span class="p">,</span>
    <span class="s1">&#39;label&#39;</span><span class="p">,</span>
    <span class="n">tokenizer_name</span> <span class="o">=</span> <span class="s2">&quot;bert-base-uncased&quot;</span><span class="p">,</span>
    <span class="n">tokenize</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">dsets</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;input_ids&#39;: [101, 2023, 2003, 1037, 5186, 2092, 1011, 2081, 2143, 1012, 1996, 3772, 1010, 5896, 1998, 4950, 1011, 2147, 2024, 2035, 2034, 1011, 3446, 1012, 1996, 2189, 2003, 2204, 1010, 2205, 1010, 2295, 2009, 2003, 3262, 2220, 1999, 1996, 2143, 1010, 2043, 2477, 2024, 2145, 4659, 15138, 2100, 1012, 2045, 2024, 2053, 2428, 18795, 2015, 1999, 1996, 3459, 1010, 2295, 2195, 5344, 2097, 2022, 5220, 1012, 1996, 2972, 3459, 2515, 2019, 6581, 3105, 2007, 1996, 5896, 1012, 1026, 7987, 1013, 1028, 1026, 7987, 1013, 1028, 2021, 2009, 2003, 2524, 2000, 3422, 1010, 2138, 2045, 2003, 2053, 2204, 2203, 2000, 1037, 3663, 2066, 1996, 2028, 3591, 1012, 2009, 2003, 2085, 19964, 2000, 7499, 1996, 2329, 2005, 4292, 18221, 1998, 7486, 2114, 2169, 2060, 1010, 1998, 2059, 10311, 2135, 14443, 2068, 2046, 2048, 3032, 1012, 2045, 2003, 2070, 7857, 1999, 2023, 3193, 1010, 2021, 2009, 1005, 1055, 2036, 2995, 2008, 2053, 2028, 3140, 18221, 1998, 7486, 1999, 1996, 2555, 2000, 11094, 16416, 2102, 2169, 2060, 2004, 2027, 2106, 2105, 1996, 2051, 1997, 13571, 1012, 2009, 3849, 2062, 3497, 2008, 1996, 2329, 3432, 2387, 1996, 13136, 2090, 1996, 11822, 1998, 2020, 12266, 2438, 2000, 18077, 2068, 2000, 2037, 2219, 4515, 1012, 1026, 7987, 1013, 1028, 1026, 7987, 1013, 1028, 1996, 2765, 2003, 2008, 2045, 2003, 2172, 18186, 1998, 29582, 3012, 1999, 1996, 3663, 1998, 2023, 2003, 2200, 16010, 2000, 3342, 1998, 2000, 2156, 2006, 1996, 3898, 1012, 2021, 2009, 2003, 2196, 4993, 2004, 1037, 2304, 1011, 1998, 1011, 2317, 2553, 1012, 2045, 2003, 2918, 2791, 1998, 11760, 2006, 2119, 3903, 1010, 1998, 2036, 1996, 3246, 2005, 2689, 1999, 1996, 3920, 4245, 1012, 1026, 7987, 1013, 1028, 1026, 7987, 1013, 1028, 2045, 2003, 18434, 1997, 1037, 4066, 1010, 1999, 1996, 2203, 1010, 2043, 16405, 3217, 2038, 2000, 2191, 1037, 2524, 3601, 2090, 1037, 2158, 2040, 2038, 9868, 2014, 2166, 1010, 2021, 2036, 5621, 3866, 2014, 1010, 1998, 2014, 2155, 2029, 2038, 4487, 6499, 7962, 2098, 2014, 1010, 2059, 2101, 2272, 2559, 2005, 2014, 1012, 2021, 2011, 2008, 2391, 1010, 2016, 2038, 2053, 5724, 2008, 2003, 2302, 2307, 3255, 2005, 2014, 1012, 1026, 7987, 1013, 1028, 1026, 7987, 1013, 1028, 2023, 2143, 7883, 1996, 4471, 2008, 2119, 7486, 1998, 18221, 2031, 2037, 6542, 19399, 1010, 1998, 2036, 2008, 2119, 2064, 2022, 10667, 25201, 1998, 11922, 2111, 1012, 1996, 4507, 1997, 13571, 3084, 2008, 2613, 6648, 2035, 1996, 2062, 16255, 8450, 1010, 2144, 2045, 2064, 2196, 2022, 2613, 16088, 2408, 1996, 2634, 1013, 4501, 3675, 1012, 1999, 2008, 3168, 1010, 2009, 2003, 2714, 2000, 1000, 2720, 1004, 3680, 1045, 10532, 1000, 1012, 1026, 7987, 1013, 1028, 1026, 7987, 1013, 1028, 1999, 1996, 2203, 1010, 2057, 2020, 5580, 2000, 2031, 2464, 1996, 2143, 1010, 2130, 2295, 1996, 5813, 2001, 27724, 2075, 1012, 2065, 1996, 2866, 1998, 2149, 2071, 3066, 2007, 2037, 2219, 15215, 1997, 14398, 2007, 2023, 2785, 1997, 3581, 2791, 1010, 2027, 2052, 5121, 2022, 2488, 2125, 1012, 102], &#39;token_type_ids&#39;: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], &#39;attention_mask&#39;: [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1], &#39;labels&#39;: tensor(1)}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

