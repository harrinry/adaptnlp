---

title: Transformers Utils


keywords: fastai
sidebar: home_sidebar

summary: "Squad Metrics from the Transformers library"
description: "Squad Metrics from the Transformers library"
nb_path: "nbs/11_inference.utils.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/11_inference.utils.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="normalize_answer" class="doc_header"><code>normalize_answer</code><a href="https://github.com/novetta/adaptnlp/tree/master/adaptnlp/inference/utils.py#L34" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>normalize_answer</code>(<strong><code>s</code></strong>:<code>str</code>)</p>
</blockquote>
<p>Lowercase text and remove punctuation, articles and extra whitespace.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>s</code></strong> : <em><code>&lt;class 'str'&gt;</code></em>  <p>Some text</p></li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><em><code>&lt;class 'str'&gt;</code></em></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_tokens" class="doc_header"><code>get_tokens</code><a href="https://github.com/novetta/adaptnlp/tree/master/adaptnlp/inference/utils.py#L56" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_tokens</code>(<strong><code>s</code></strong>:<code>str</code>)</p>
</blockquote>
<p>Get normalized tokens if s is not none</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>s</code></strong> : <em><code>&lt;class 'str'&gt;</code></em>  <p>Some text</p></li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><em><code>&lt;class 'list'&gt;</code></em>   <p>Either a normalized answer or an empty array</p></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="compute_exact" class="doc_header"><code>compute_exact</code><a href="https://github.com/novetta/adaptnlp/tree/master/adaptnlp/inference/utils.py#L64" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>compute_exact</code>(<strong><code>a_gold</code></strong>:<code>str</code>, <strong><code>a_pred</code></strong>:<code>str</code>)</p>
</blockquote>
<p>Whether <code>a_gold</code> and <code>a_pred</code> match after normalizing</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>a_gold</code></strong> : <em><code>&lt;class 'str'&gt;</code></em></p>
</li>
<li><p><strong><code>a_pred</code></strong> : <em><code>&lt;class 'str'&gt;</code></em></p>
</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><em><code>&lt;class 'int'&gt;</code></em></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="compute_f1" class="doc_header"><code>compute_f1</code><a href="https://github.com/novetta/adaptnlp/tree/master/adaptnlp/inference/utils.py#L72" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>compute_f1</code>(<strong><code>a_gold</code></strong>:<code>str</code>, <strong><code>a_pred</code></strong>:<code>str</code>)</p>
</blockquote>
<p>Calculate the F1 score between <code>a_gold</code> and <code>a_pred</code></p>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>a_gold</code></strong> : <em><code>&lt;class 'str'&gt;</code></em></p>
</li>
<li><p><strong><code>a_pred</code></strong> : <em><code>&lt;class 'str'&gt;</code></em></p>
</li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><em><code>&lt;class 'float'&gt;</code></em></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_raw_scores" class="doc_header"><code>get_raw_scores</code><a href="https://github.com/novetta/adaptnlp/tree/master/adaptnlp/inference/utils.py#L92" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_raw_scores</code>(<strong><code>examples</code></strong>:<code>list</code>, <strong><code>preds</code></strong>:<code>list</code>)</p>
</blockquote>
<p>Computes the exact and F1 scores</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>examples</code></strong> : <em><code>&lt;class 'list'&gt;</code></em>  <p>Ground truth examples</p></li>
</ul>
<ul>
<li><strong><code>preds</code></strong> : <em><code>&lt;class 'list'&gt;</code></em> <p>Model predictions</p></li>
</ul>
<p><strong>Returns</strong>:</p>
<ul>
<li><em><code>(&lt;class 'float'&gt;, &lt;class 'float'&gt;)</code></em>   <p>The exact score and f1 score</p></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="apply_no_ans_threshold" class="doc_header"><code>apply_no_ans_threshold</code><a href="https://github.com/novetta/adaptnlp/tree/master/adaptnlp/inference/utils.py#L123" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>apply_no_ans_threshold</code>(<strong><code>scores</code></strong>:<code>list</code>, <strong><code>na_probs</code></strong>:<code>list</code>, <strong><code>qid_to_has_ans</code></strong>:<code>list</code>, <strong><code>na_prob_thresh</code></strong>:<code>float</code>)</p>
</blockquote>
<p>Applies a threshold to non-answers</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>scores</code></strong> : <em><code>&lt;class 'list'&gt;</code></em></p>
</li>
<li><p><strong><code>na_probs</code></strong> : <em><code>&lt;class 'list'&gt;</code></em></p>
</li>
<li><p><strong><code>qid_to_has_ans</code></strong> : <em><code>&lt;class 'list'&gt;</code></em></p>
</li>
<li><p><strong><code>na_prob_thresh</code></strong> : <em><code>&lt;class 'float'&gt;</code></em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="make_eval_dict" class="doc_header"><code>make_eval_dict</code><a href="https://github.com/novetta/adaptnlp/tree/master/adaptnlp/inference/utils.py#L140" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>make_eval_dict</code>(<strong><code>exact_scores</code></strong>:<code>list</code>, <strong><code>f1_scores</code></strong>:<code>list</code>, <strong><code>qid_list</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Generates an eval dictionary with exact and F1 scores</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>exact_scores</code></strong> : <em><code>&lt;class 'list'&gt;</code></em>  <p>Exact scores</p></li>
</ul>
<ul>
<li><strong><code>f1_scores</code></strong> : <em><code>&lt;class 'list'&gt;</code></em> <p>F1 Scores</p></li>
</ul>
<ul>
<li><strong><code>qid_list</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em>  <p>QID's</p></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="merge_eval" class="doc_header"><code>merge_eval</code><a href="https://github.com/novetta/adaptnlp/tree/master/adaptnlp/inference/utils.py#L166" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>merge_eval</code>(<strong><code>main_eval</code></strong>, <strong><code>new_eval</code></strong>, <strong><code>prefix</code></strong>)</p>
</blockquote>
<p>Merges eval dictionaries inplace based on prefix</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>main_eval</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>new_eval</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>prefix</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="find_best_thresh_v2" class="doc_header"><code>find_best_thresh_v2</code><a href="https://github.com/novetta/adaptnlp/tree/master/adaptnlp/inference/utils.py#L172" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>find_best_thresh_v2</code>(<strong><code>preds</code></strong>, <strong><code>scores</code></strong>, <strong><code>na_probs</code></strong>, <strong><code>qid_to_has_ans</code></strong>)</p>
</blockquote>
<p>Finds the best score threshold</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>preds</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em>   <p>Model predictions</p></li>
</ul>
<ul>
<li><strong><code>scores</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em>  <p>Real scores</p></li>
</ul>
<ul>
<li><strong><code>na_probs</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em>    <p>Probabilities for NA</p></li>
</ul>
<ul>
<li><strong><code>qid_to_has_ans</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="find_all_best_thresh_v2" class="doc_header"><code>find_all_best_thresh_v2</code><a href="https://github.com/novetta/adaptnlp/tree/master/adaptnlp/inference/utils.py#L216" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>find_all_best_thresh_v2</code>(<strong><code>main_eval</code></strong>, <strong><code>preds</code></strong>, <strong><code>exact_raw</code></strong>, <strong><code>f1_raw</code></strong>, <strong><code>na_probs</code></strong>, <strong><code>qid_to_has_ans</code></strong>)</p>
</blockquote>
<p>Finds the best threshold for all inputs</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>main_eval</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em>   <p>Main evaluation dictionary</p></li>
</ul>
<ul>
<li><strong><code>preds</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em>   <p>A list of predictions</p></li>
</ul>
<ul>
<li><strong><code>exact_raw</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em>   <p>A list of exact scores</p></li>
</ul>
<ul>
<li><strong><code>f1_raw</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em>  <p>A list of F1 scores</p></li>
</ul>
<ul>
<li><strong><code>na_probs</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em>    <p>A list of NA probabilities</p></li>
</ul>
<ul>
<li><strong><code>qid_to_has_ans</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="find_best_thresh" class="doc_header"><code>find_best_thresh</code><a href="https://github.com/novetta/adaptnlp/tree/master/adaptnlp/inference/utils.py#L239" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>find_best_thresh</code>(<strong><code>preds</code></strong>, <strong><code>scores</code></strong>, <strong><code>na_probs</code></strong>, <strong><code>qid_to_has_ans</code></strong>)</p>
</blockquote>
<p>Finds best answer threshold</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>preds</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em>   <p>Model predictions</p></li>
</ul>
<ul>
<li><strong><code>scores</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em>  <p>Real scores</p></li>
</ul>
<ul>
<li><strong><code>na_probs</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em>    <p>Probabilities for NA</p></li>
</ul>
<ul>
<li><strong><code>qid_to_has_ans</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="find_all_best_thresh" class="doc_header"><code>find_all_best_thresh</code><a href="https://github.com/novetta/adaptnlp/tree/master/adaptnlp/inference/utils.py#L268" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>find_all_best_thresh</code>(<strong><code>main_eval</code></strong>, <strong><code>preds</code></strong>, <strong><code>exact_raw</code></strong>, <strong><code>f1_raw</code></strong>, <strong><code>na_probs</code></strong>, <strong><code>qid_to_has_ans</code></strong>)</p>
</blockquote>
<p>Finds the best threshold for all inputs</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>main_eval</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em>   <p>Main evaluation dictionary</p></li>
</ul>
<ul>
<li><strong><code>preds</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em>   <p>A list of predictions</p></li>
</ul>
<ul>
<li><strong><code>exact_raw</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em>   <p>A list of exact scores</p></li>
</ul>
<ul>
<li><strong><code>f1_raw</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em>  <p>A list of F1 scores</p></li>
</ul>
<ul>
<li><strong><code>na_probs</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em>    <p>A list of NA probabilities</p></li>
</ul>
<ul>
<li><strong><code>qid_to_has_ans</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="squad_evaluate" class="doc_header"><code>squad_evaluate</code><a href="https://github.com/novetta/adaptnlp/tree/master/adaptnlp/inference/utils.py#L288" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>squad_evaluate</code>(<strong><code>examples</code></strong>, <strong><code>preds</code></strong>, <strong><code>no_answer_probs</code></strong>=<em><code>None</code></em>, <strong><code>no_answer_probability_threshold</code></strong>=<em><code>1.0</code></em>)</p>
</blockquote>
<p>Evalues SQuAD scores on inputs</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><strong><code>examples</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em>    <p>Ground truth examples</p></li>
</ul>
<ul>
<li><strong><code>preds</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em>   <p>Model predictions</p></li>
</ul>
<ul>
<li><p><strong><code>no_answer_probs</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>no_answer_probability_threshold</code></strong> : <em><code>&lt;class 'float'&gt;</code></em>, <em>optional</em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_final_text" class="doc_header"><code>get_final_text</code><a href="https://github.com/novetta/adaptnlp/tree/master/adaptnlp/inference/utils.py#L339" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_final_text</code>(<strong><code>pred_text</code></strong>, <strong><code>orig_text</code></strong>, <strong><code>do_lower_case</code></strong>, <strong><code>verbose_logging</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Project the tokenized prediction back to the original text.</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>pred_text</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>orig_text</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>do_lower_case</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>verbose_logging</code></strong> : <em><code>&lt;class 'bool'&gt;</code></em>, <em>optional</em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="compute_predictions_logits" class="doc_header"><code>compute_predictions_logits</code><a href="https://github.com/novetta/adaptnlp/tree/master/adaptnlp/inference/utils.py#L472" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>compute_predictions_logits</code>(<strong><code>all_examples</code></strong>, <strong><code>all_features</code></strong>, <strong><code>all_results</code></strong>, <strong><code>n_best_size</code></strong>, <strong><code>max_answer_length</code></strong>, <strong><code>do_lower_case</code></strong>, <strong><code>verbose_logging</code></strong>, <strong><code>version_2_with_negative</code></strong>, <strong><code>null_score_diff_threshold</code></strong>, <strong><code>tokenizer</code></strong>, <strong><code>output_prediction_file</code></strong>=<em><code>None</code></em>, <strong><code>output_nbest_file</code></strong>=<em><code>None</code></em>, <strong><code>output_null_log_odds_file</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>all_examples</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>all_features</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>all_results</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>n_best_size</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>max_answer_length</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>do_lower_case</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>verbose_logging</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>version_2_with_negative</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>null_score_diff_threshold</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>tokenizer</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>output_prediction_file</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>output_nbest_file</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>output_null_log_odds_file</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="compute_predictions_log_probs" class="doc_header"><code>compute_predictions_log_probs</code><a href="https://github.com/novetta/adaptnlp/tree/master/adaptnlp/inference/utils.py#L717" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>compute_predictions_log_probs</code>(<strong><code>all_examples</code></strong>, <strong><code>all_features</code></strong>, <strong><code>all_results</code></strong>, <strong><code>n_best_size</code></strong>, <strong><code>max_answer_length</code></strong>, <strong><code>start_n_top</code></strong>, <strong><code>end_n_top</code></strong>, <strong><code>version_2_with_negative</code></strong>, <strong><code>tokenizer</code></strong>, <strong><code>verbose_logging</code></strong>, <strong><code>output_prediction_file</code></strong>=<em><code>None</code></em>, <strong><code>output_nbest_file</code></strong>=<em><code>None</code></em>, <strong><code>output_null_log_odds_file</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>XLNet write prediction logic (more complex than Bert's).
Write final predictions to the json file and log-odds of null if needed.
Requires utils_squad_evaluate.py</p>
<p><strong>Parameters:</strong></p>
<ul>
<li><p><strong><code>all_examples</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>all_features</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>all_results</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>n_best_size</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>max_answer_length</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>start_n_top</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>end_n_top</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>version_2_with_negative</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>tokenizer</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>verbose_logging</code></strong> : <em><code>&lt;class 'inspect._empty'&gt;</code></em></p>
</li>
<li><p><strong><code>output_prediction_file</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>output_nbest_file</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
<li><p><strong><code>output_null_log_odds_file</code></strong> : <em><code>&lt;class 'NoneType'&gt;</code></em>, <em>optional</em></p>
</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

