---

title: Tutorial - Token Tagging with AdaptNLP


keywords: fastai
sidebar: home_sidebar

summary: "Using EasyTokenTagger to quickly perform POS tagging"
description: "Using EasyTokenTagger to quickly perform POS tagging"
nb_path: "nbs/05a_tutorial.token_tagging.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/05a_tutorial.token_tagging.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll import the <code>adaptnlp</code> <a href="/adaptnlp/token_classification.html#EasyTokenTagger"><code>EasyTokenTagger</code></a> class:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">adaptnlp</span> <span class="kn">import</span> <span class="n">EasyTokenTagger</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's write some simple example text, and instantiate an <a href="/adaptnlp/token_classification.html#EasyTokenTagger"><code>EasyTokenTagger</code></a>:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">example_text</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;Novetta Solutions is the best. Albert Einstein used to be employed at Novetta Solutions. </span>
<span class="s1">The Wright brothers loved to visit the JBF headquarters, and they would have a chat with Albert.&#39;&#39;&#39;</span>
<span class="n">tagger</span> <span class="o">=</span> <span class="n">EasyTokenTagger</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="With-Transformers">With Transformers<a class="anchor-link" href="#With-Transformers"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First we will use some <code>Transformers</code> models, specifically <code>bert</code>.</p>
<p>We'll search <code>HuggingFace</code> for the model we want, in this case we want to use <code>sshleifer</code>'s <code>tiny-dbmdz-bert</code> model:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">adaptnlp</span> <span class="kn">import</span> <span class="n">HFModelHub</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hub</span> <span class="o">=</span> <span class="n">HFModelHub</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">hub</span><span class="o">.</span><span class="n">search_model_by_name</span><span class="p">(</span><span class="s1">&#39;sshleifer/tiny-dbmdz-bert&#39;</span><span class="p">,</span> <span class="n">user_uploaded</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span> <span class="n">model</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Model Name: sshleifer/tiny-dbmdz-bert-large-cased-finetuned-conll03-english, Tasks: [token-classification]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next we'll use our <code>tagger</code> to generate some sentences:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sentences</span> <span class="o">=</span> <span class="n">tagger</span><span class="o">.</span><span class="n">tag_text</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">example_text</span><span class="p">,</span> <span class="n">model_name_or_path</span> <span class="o">=</span> <span class="n">model</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2021-10-05 17:45:28,242 loading file /root/.flair/models/tiny-dbmdz-bert-large-cased-finetuned-conll03-english/1e2c09da4ad5b3257008353a87852a7148389cc8308b91cf837f066b95650a0d.595173de82e795b5e4022dca79d10d885137a50ed2ee3974f15a75d328c0cd0a
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And then look at some of our results:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;List string outputs of tags:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">sen</span> <span class="ow">in</span> <span class="n">sentences</span><span class="p">[</span><span class="s1">&#39;tags&#39;</span><span class="p">]:</span>
    <span class="n">pprint</span><span class="p">(</span><span class="n">sen</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>List string outputs of tags:

[{&#39;entity&#39;: &#39;I-LOC&#39;, &#39;score&#39;: 0.11716679483652115, &#39;word&#39;: &#39;[CLS] Novetta&#39;},
 {&#39;entity&#39;: &#39;B-ORG&#39;, &#39;score&#39;: 0.11758644878864288, &#39;word&#39;: &#39;Solutions&#39;},
 {&#39;entity&#39;: &#39;I-LOC&#39;, &#39;score&#39;: 0.11716679483652115, &#39;word&#39;: &#39;is the&#39;},
 {&#39;entity&#39;: &#39;B-ORG&#39;, &#39;score&#39;: 0.11758644878864288, &#39;word&#39;: &#39;best&#39;},
 {&#39;entity&#39;: &#39;I-LOC&#39;,
  &#39;score&#39;: 0.11716679483652115,
  &#39;word&#39;: &#39;. Albert Einstein used to be employed&#39;},
 {&#39;entity&#39;: &#39;B-ORG&#39;, &#39;score&#39;: 0.11758644878864288, &#39;word&#39;: &#39;at Nov&#39;},
 {&#39;entity&#39;: &#39;I-LOC&#39;,
  &#39;score&#39;: 0.11716679483652115,
  &#39;word&#39;: &#39;##etta Solutions. The Wright brothers loved to visit&#39;},
 {&#39;entity&#39;: &#39;B-ORG&#39;, &#39;score&#39;: 0.11758644878864288, &#39;word&#39;: &#39;the&#39;},
 {&#39;entity&#39;: &#39;I-LOC&#39;, &#39;score&#39;: 0.11716679483652115, &#39;word&#39;: &#39;JBF&#39;},
 {&#39;entity&#39;: &#39;B-ORG&#39;, &#39;score&#39;: 0.11758644878864288, &#39;word&#39;: &#39;headquarters&#39;},
 {&#39;entity&#39;: &#39;I-LOC&#39;, &#39;score&#39;: 0.11716679483652115, &#39;word&#39;: &#39;, and they&#39;},
 {&#39;entity&#39;: &#39;B-ORG&#39;, &#39;score&#39;: 0.11758644878864288, &#39;word&#39;: &#39;would&#39;},
 {&#39;entity&#39;: &#39;I-LOC&#39;,
  &#39;score&#39;: 0.11716679483652115,
  &#39;word&#39;: &#39;have a chat with Albert. [SEP]&#39;}]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="With-Flair">With Flair<a class="anchor-link" href="#With-Flair"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Named-Entity-Recognition-(NER)">Named Entity Recognition (NER)<a class="anchor-link" href="#Named-Entity-Recognition-(NER)"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With Flair we can follow a similar setup to earlier, searching HuggingFace for valid <code>ner</code> models. In our case we'll use <code>Flair</code>'s <code>ner-english-ontonotes-fast</code> model</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">adaptnlp</span> <span class="kn">import</span> <span class="n">FlairModelHub</span>
<span class="n">hub</span> <span class="o">=</span> <span class="n">FlairModelHub</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">hub</span><span class="o">.</span><span class="n">search_model_by_name</span><span class="p">(</span><span class="s1">&#39;ontonotes-fast&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span> <span class="n">model</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Model Name: flair/ner-english-ontonotes-fast, Tasks: [token-classification], Source: HuggingFace Model Hub</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then we'll tag the string:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sentences</span> <span class="o">=</span> <span class="n">tagger</span><span class="o">.</span><span class="n">tag_text</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">example_text</span><span class="p">,</span> <span class="n">model_name_or_path</span> <span class="o">=</span> <span class="n">model</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2021-10-05 17:48:09,267 loading file /root/.flair/models/ner-english-ontonotes-fast/0d55dd3b912da9cf26e003035a0c269a0e9ab222f0be1e48a3bbba3a58c0fed0.c9907cd5fde3ce84b71a4172e7ca03841cd81ab71d13eb68aa08b259f57c00b6
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And we can get back a JSON of each word and its entities:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pprint</span><span class="p">(</span><span class="n">sentences</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;entities&#39;</span><span class="p">][:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[{&#39;confidence&#39;: 0.7553082704544067,
  &#39;end_pos&#39;: 17,
  &#39;labels&#39;: [ORG (0.7553)],
  &#39;start_pos&#39;: 0,
  &#39;text&#39;: &#39;Novetta Solutions&#39;,
  &#39;value&#39;: &#39;ORG&#39;},
 {&#39;confidence&#39;: 0.9927975535392761,
  &#39;end_pos&#39;: 46,
  &#39;labels&#39;: [PERSON (0.9928)],
  &#39;start_pos&#39;: 31,
  &#39;text&#39;: &#39;Albert Einstein&#39;,
  &#39;value&#39;: &#39;PERSON&#39;},
 {&#39;confidence&#39;: 0.7496212422847748,
  &#39;end_pos&#39;: 87,
  &#39;labels&#39;: [ORG (0.7496)],
  &#39;start_pos&#39;: 70,
  &#39;text&#39;: &#39;Novetta Solutions&#39;,
  &#39;value&#39;: &#39;ORG&#39;},
 {&#39;confidence&#39;: 0.9998451471328735,
  &#39;end_pos&#39;: 99,
  &#39;labels&#39;: [PERSON (0.9998)],
  &#39;start_pos&#39;: 93,
  &#39;text&#39;: &#39;Wright&#39;,
  &#39;value&#39;: &#39;PERSON&#39;},
 {&#39;confidence&#39;: 0.967128336429596,
  &#39;end_pos&#39;: 131,
  &#39;labels&#39;: [ORG (0.9671)],
  &#39;start_pos&#39;: 128,
  &#39;text&#39;: &#39;JBF&#39;,
  &#39;value&#39;: &#39;ORG&#39;}]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Parts-of-Speech">Parts of Speech<a class="anchor-link" href="#Parts-of-Speech"> </a></h3><p>Next we'll look at a parts-of-speech tagger.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can simply pass in <code>"pos"</code>, but let's use our search API to find an english POS tagger:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hub</span><span class="o">.</span><span class="n">search_model_by_task</span><span class="p">(</span><span class="s1">&#39;pos&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[Model Name: flair/pos-english-fast, Tasks: [token-classification], Source: HuggingFace Model Hub,
 Model Name: flair/pos-english, Tasks: [token-classification], Source: HuggingFace Model Hub,
 Model Name: flair/upos-english-fast, Tasks: [token-classification], Source: HuggingFace Model Hub,
 Model Name: flair/upos-english, Tasks: [token-classification], Source: HuggingFace Model Hub,
 Model Name: flair/upos-multi-fast, Tasks: [token-classification], Source: HuggingFace Model Hub,
 Model Name: flair/upos-multi, Tasks: [token-classification], Source: HuggingFace Model Hub,
 Model Name: flair/upos, Tasks: [token-classification], Source: Flair&#39;s Private Model Hub,
 Model Name: flair/upos-fast, Tasks: [token-classification], Source: Flair&#39;s Private Model Hub,
 Model Name: flair/pos, Tasks: [token-classification], Source: Flair&#39;s Private Model Hub,
 Model Name: flair/pos-fast, Tasks: [token-classification], Source: Flair&#39;s Private Model Hub,
 Model Name: flair/pos-multi, Tasks: [token-classification], Source: Flair&#39;s Private Model Hub,
 Model Name: flair/multi-pos, Tasks: [token-classification], Source: Flair&#39;s Private Model Hub,
 Model Name: flair/pos-multi-fast, Tasks: [token-classification], Source: Flair&#39;s Private Model Hub,
 Model Name: flair/multi-pos-fast, Tasks: [token-classification], Source: Flair&#39;s Private Model Hub,
 Model Name: flair/da-pos, Tasks: [token-classification], Source: Flair&#39;s Private Model Hub,
 Model Name: flair/de-pos, Tasks: [token-classification], Source: Flair&#39;s Private Model Hub,
 Model Name: flair/de-pos-tweets, Tasks: [token-classification], Source: Flair&#39;s Private Model Hub,
 Model Name: flair/ml-pos, Tasks: [token-classification], Source: Flair&#39;s Private Model Hub,
 Model Name: flair/ml-upos, Tasks: [token-classification], Source: Flair&#39;s Private Model Hub,
 Model Name: flair/pt-pos-clinical, Tasks: [token-classification], Source: Flair&#39;s Private Model Hub]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll use the <code>pos-english-fast</code> model</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">hub</span><span class="o">.</span><span class="n">search_model_by_name</span><span class="p">(</span><span class="s1">&#39;pos-english-fast&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span> <span class="n">model</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Model Name: flair/pos-english-fast, Tasks: [token-classification], Source: HuggingFace Model Hub</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sentences</span> <span class="o">=</span> <span class="n">tagger</span><span class="o">.</span><span class="n">tag_text</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">example_text</span><span class="p">,</span> <span class="n">model_name_or_path</span> <span class="o">=</span> <span class="n">model</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2021-10-05 17:49:02,823 loading file /root/.flair/models/pos-english-fast/36f7923039eed4c66e4275927daaff6cd275997d61d238355fb1fe0338fe10a1.ff87e5b4e47fdb42a0c00237d9506c671db773e0a7932179ace82e584383a1b8
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then just as before, we get a JSON of our POS:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pprint</span><span class="p">(</span><span class="n">sentences</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;entities&#39;</span><span class="p">][:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[{&#39;confidence&#39;: 0.998687207698822,
  &#39;end_pos&#39;: 7,
  &#39;labels&#39;: [NNP (0.9987)],
  &#39;start_pos&#39;: 0,
  &#39;text&#39;: &#39;Novetta&#39;,
  &#39;value&#39;: &#39;NNP&#39;},
 {&#39;confidence&#39;: 0.8011120557785034,
  &#39;end_pos&#39;: 17,
  &#39;labels&#39;: [NNPS (0.8011)],
  &#39;start_pos&#39;: 8,
  &#39;text&#39;: &#39;Solutions&#39;,
  &#39;value&#39;: &#39;NNPS&#39;},
 {&#39;confidence&#39;: 0.9999979734420776,
  &#39;end_pos&#39;: 20,
  &#39;labels&#39;: [VBZ (1.0)],
  &#39;start_pos&#39;: 18,
  &#39;text&#39;: &#39;is&#39;,
  &#39;value&#39;: &#39;VBZ&#39;},
 {&#39;confidence&#39;: 0.9999998807907104,
  &#39;end_pos&#39;: 24,
  &#39;labels&#39;: [DT (1.0)],
  &#39;start_pos&#39;: 21,
  &#39;text&#39;: &#39;the&#39;,
  &#39;value&#39;: &#39;DT&#39;},
 {&#39;confidence&#39;: 0.9101433157920837,
  &#39;end_pos&#39;: 29,
  &#39;labels&#39;: [JJS (0.9101)],
  &#39;start_pos&#39;: 25,
  &#39;text&#39;: &#39;best&#39;,
  &#39;value&#39;: &#39;JJS&#39;}]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Chunk">Chunk<a class="anchor-link" href="#Chunk"> </a></h3><p>As with everything before, <code>chunk</code> tasks operate the same way. You can either pass <code>chunk</code> to get the default <code>en-chunk</code> model, or we can search the model hub:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">models</span> <span class="o">=</span> <span class="n">hub</span><span class="o">.</span><span class="n">search_model_by_task</span><span class="p">(</span><span class="s1">&#39;chunk&#39;</span><span class="p">);</span> <span class="n">models</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[Model Name: flair/chunk-english-fast, Tasks: [token-classification], Source: HuggingFace Model Hub,
 Model Name: flair/chunk-english, Tasks: [token-classification], Source: HuggingFace Model Hub,
 Model Name: flair/chunk, Tasks: [token-classification], Source: Flair&#39;s Private Model Hub,
 Model Name: flair/chunk-fast, Tasks: [token-classification], Source: Flair&#39;s Private Model Hub]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll use the <code>fast</code> model again:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">model</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Model Name: flair/chunk-english-fast, Tasks: [token-classification], Source: HuggingFace Model Hub</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sentences</span> <span class="o">=</span> <span class="n">tagger</span><span class="o">.</span><span class="n">tag_text</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">example_text</span><span class="p">,</span> <span class="n">model_name_or_path</span> <span class="o">=</span> <span class="n">model</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2021-10-05 17:49:05,772 loading file /root/.flair/models/chunk-english-fast/be3a207f4993dd6d174d5083341a717d371ec16f721358e7a4d72158ebab28a6.a7f897d05c83e618a8235bbb7ddfca5a79d2daefb8a97c776eb73f97dbaea508
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's view our results.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pprint</span><span class="p">(</span><span class="n">sentences</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;entities&#39;</span><span class="p">][:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[{&#39;confidence&#39;: 0.9879125952720642,
  &#39;end_pos&#39;: 17,
  &#39;labels&#39;: [NP (0.9879)],
  &#39;start_pos&#39;: 0,
  &#39;text&#39;: &#39;Novetta Solutions&#39;,
  &#39;value&#39;: &#39;NP&#39;},
 {&#39;confidence&#39;: 0.9999805688858032,
  &#39;end_pos&#39;: 20,
  &#39;labels&#39;: [VP (1.0)],
  &#39;start_pos&#39;: 18,
  &#39;text&#39;: &#39;is&#39;,
  &#39;value&#39;: &#39;VP&#39;},
 {&#39;confidence&#39;: 0.8664445877075195,
  &#39;end_pos&#39;: 29,
  &#39;labels&#39;: [NP (0.8664)],
  &#39;start_pos&#39;: 21,
  &#39;text&#39;: &#39;the best&#39;,
  &#39;value&#39;: &#39;NP&#39;},
 {&#39;confidence&#39;: 0.9803058207035065,
  &#39;end_pos&#39;: 46,
  &#39;labels&#39;: [NP (0.9803)],
  &#39;start_pos&#39;: 31,
  &#39;text&#39;: &#39;Albert Einstein&#39;,
  &#39;value&#39;: &#39;NP&#39;},
 {&#39;confidence&#39;: 0.931873619556427,
  &#39;end_pos&#39;: 66,
  &#39;labels&#39;: [VP (0.9319)],
  &#39;start_pos&#39;: 47,
  &#39;text&#39;: &#39;used to be employed&#39;,
  &#39;value&#39;: &#39;VP&#39;}]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Frame">Frame<a class="anchor-link" href="#Frame"> </a></h3><p>We can either delegate the <code>"frame"</code> task and use the default <code>en-frame-ontonotes</code> model, or search the API for usable models:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">models</span> <span class="o">=</span> <span class="n">hub</span><span class="o">.</span><span class="n">search_model_by_task</span><span class="p">(</span><span class="s2">&quot;frame&quot;</span><span class="p">);</span> <span class="n">models</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[Model Name: flair/frame-english-fast, Tasks: [token-classification], Source: HuggingFace Model Hub,
 Model Name: flair/frame-english, Tasks: [token-classification], Source: HuggingFace Model Hub,
 Model Name: flair/frame, Tasks: [token-classification], Source: Flair&#39;s Private Model Hub,
 Model Name: flair/frame-fast, Tasks: [token-classification], Source: Flair&#39;s Private Model Hub]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Again we will use the "fast" model:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">model</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Model Name: flair/frame-english-fast, Tasks: [token-classification], Source: HuggingFace Model Hub</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sentences</span> <span class="o">=</span> <span class="n">tagger</span><span class="o">.</span><span class="n">tag_text</span><span class="p">(</span><span class="n">text</span> <span class="o">=</span> <span class="n">example_text</span><span class="p">,</span> <span class="n">model_name_or_path</span> <span class="o">=</span> <span class="n">model</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2021-10-05 17:49:14,076 loading file /root/.flair/models/frame-english-fast/b2f10f9bc52898d86d8e6f3bf20369d681cc1e9badcb71650aa274ac696433c7.643ca10453770684aca3f2e886a7243adb2979c67a68de6379e50ccf5dc248da
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pprint</span><span class="p">(</span><span class="n">sentences</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;entities&#39;</span><span class="p">][:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[{&#39;confidence&#39;: 0.9969749450683594,
  &#39;end_pos&#39;: 20,
  &#39;labels&#39;: [be.01 (0.997)],
  &#39;start_pos&#39;: 18,
  &#39;text&#39;: &#39;is&#39;,
  &#39;value&#39;: &#39;be.01&#39;},
 {&#39;confidence&#39;: 0.8932156562805176,
  &#39;end_pos&#39;: 51,
  &#39;labels&#39;: [use.03 (0.8932)],
  &#39;start_pos&#39;: 47,
  &#39;text&#39;: &#39;used&#39;,
  &#39;value&#39;: &#39;use.03&#39;},
 {&#39;confidence&#39;: 0.9950985312461853,
  &#39;end_pos&#39;: 57,
  &#39;labels&#39;: [be.03 (0.9951)],
  &#39;start_pos&#39;: 55,
  &#39;text&#39;: &#39;be&#39;,
  &#39;value&#39;: &#39;be.03&#39;},
 {&#39;confidence&#39;: 0.6651257872581482,
  &#39;end_pos&#39;: 66,
  &#39;labels&#39;: [employ.01 (0.6651)],
  &#39;start_pos&#39;: 58,
  &#39;text&#39;: &#39;employed&#39;,
  &#39;value&#39;: &#39;employ.01&#39;},
 {&#39;confidence&#39;: 0.7210038900375366,
  &#39;end_pos&#39;: 114,
  &#39;labels&#39;: [love.01 (0.721)],
  &#39;start_pos&#39;: 109,
  &#39;text&#39;: &#39;loved&#39;,
  &#39;value&#39;: &#39;love.01&#39;}]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote><p>Notice:Pay attention to the "fast" versus regular naming. "fast" models are designed to be extremely efficient on the CPU, and are worth checking out</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Tag-Tokens-with-All-Loaded-Models-At-Once">Tag Tokens with All Loaded Models At Once<a class="anchor-link" href="#Tag-Tokens-with-All-Loaded-Models-At-Once"> </a></h3><p>As different taggers are loaded into memory, we can tag with all of them at once, for example we'll make a new <a href="/adaptnlp/token_classification.html#EasyTokenTagger"><code>EasyTokenTagger</code></a> and load in a <code>ner</code> and <code>pos</code> tagger:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tagger</span> <span class="o">=</span> <span class="n">EasyTokenTagger</span><span class="p">()</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">tagger</span><span class="o">.</span><span class="n">tag_text</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">example_text</span><span class="p">,</span> <span class="n">model_name_or_path</span><span class="o">=</span><span class="s2">&quot;flair/ner-english-ontonotes&quot;</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">tagger</span><span class="o">.</span><span class="n">tag_text</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">example_text</span><span class="p">,</span> <span class="n">model_name_or_path</span><span class="o">=</span><span class="s2">&quot;pos&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2021-10-05 17:49:16,462 loading file /root/.flair/models/ner-english-ontonotes-fast/0d55dd3b912da9cf26e003035a0c269a0e9ab222f0be1e48a3bbba3a58c0fed0.c9907cd5fde3ce84b71a4172e7ca03841cd81ab71d13eb68aa08b259f57c00b6
2021-10-05 17:49:21,049 loading file /root/.flair/models/pos-english-fast/36f7923039eed4c66e4275927daaff6cd275997d61d238355fb1fe0338fe10a1.ff87e5b4e47fdb42a0c00237d9506c671db773e0a7932179ace82e584383a1b8
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Before finally using both at once:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sentences</span> <span class="o">=</span> <span class="n">tagger</span><span class="o">.</span><span class="n">tag_all</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">example_text</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And now we can look at the entities tagged of each kind:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sentences</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[{&#39;text&#39;: &#39;Novetta Solutions&#39;,
  &#39;start_pos&#39;: 0,
  &#39;end_pos&#39;: 17,
  &#39;labels&#39;: [ORG (0.7553)],
  &#39;value&#39;: [&#39;ORG&#39;],
  &#39;confidence&#39;: [0.7553082704544067]},
 {&#39;text&#39;: &#39;Albert Einstein&#39;,
  &#39;start_pos&#39;: 31,
  &#39;end_pos&#39;: 46,
  &#39;labels&#39;: [PERSON (0.9928)],
  &#39;value&#39;: [&#39;PERSON&#39;],
  &#39;confidence&#39;: [0.9927975535392761]},
 {&#39;text&#39;: &#39;Novetta Solutions&#39;,
  &#39;start_pos&#39;: 70,
  &#39;end_pos&#39;: 87,
  &#39;labels&#39;: [ORG (0.7496)],
  &#39;value&#39;: [&#39;ORG&#39;],
  &#39;confidence&#39;: [0.7496212422847748]},
 {&#39;text&#39;: &#39;Wright&#39;,
  &#39;start_pos&#39;: 93,
  &#39;end_pos&#39;: 99,
  &#39;labels&#39;: [PERSON (0.9998), NNP (0.996)],
  &#39;value&#39;: [&#39;PERSON&#39;, &#39;NNP&#39;],
  &#39;confidence&#39;: [0.9998451471328735, 0.9959734082221985]},
 {&#39;text&#39;: &#39;JBF&#39;,
  &#39;start_pos&#39;: 128,
  &#39;end_pos&#39;: 131,
  &#39;labels&#39;: [ORG (0.9671), NNP (1.0)],
  &#39;value&#39;: [&#39;ORG&#39;, &#39;NNP&#39;],
  &#39;confidence&#39;: [0.967128336429596, 0.9999892711639404]}]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

